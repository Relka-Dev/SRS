WindowManager:
    ServerResearchWindow:
    InitializeLoginWindow:
    AddFirstAdminWindow:
    MainWindow:
    NavigationFaceManagementWindow:
    LoginWindow:
    AddUserWindow:
    CamerasManagementWindow:
    UpdateUserWindow:


<MainWindow>:
    name: "main"
    
    FloatLayout:
        GridLayout:
            cols: 3
            size_hint: 1, 0.1
            pos_hint: {'top': 1}

            Button:
                text: "Déconnexion"
                disabled: True
                on_release:
                    app.root.current = "previous_page"
                    root.manager.transition.direction = "right"

            Label:
                text: "SRS : Page Principale"
                bold: True

            Image:
                source: 'Ressources/logo.png'
        
        GridLayout:
            cols: 1
            size_hint_y: 0.9

            Button:
                id: face_management_button
                size_hint: 0.5, 0.5
                font_size: '15sp' 
                text: "Gestion des données faciales"
                on_release:
                    app.root.current = "navigationFaceManagement"
                    root.manager.transition.direction = "left"
        
            Button:
                id: wifi_cameras_button
                size_hint: 0.5, 0.5
                font_size: '15sp'
                text: "Gestion des cameras wifi"
                on_release:
                    app.root.current = "camerasManagement"
                    root.manager.transition.direction = "left"

            Button:
                size_hint: 0.5, 0.5
                font_size: '15sp'
                text: "Reconnaissance Spaciale"
                disabled: True
            
            

<ServerResearchWindow>
    name: "research"
    
    GridLayout:
        cols: 1
        
        Label:
            text: "Recherche de serveur"
            font_size: '24sp' 
            bold: True
        Image:
            source: 'Ressources/logo.png'
        Label:
            id: state_label
            text: "Veuillez patienter"
        
        Button:
            id: retry_button
            size_hint: 0.5, 0.5
            font_size: '15sp' 
            text: "Réessayer"
            on_release: root.retry()
            disabled: True

<InitializeLoginWindow>
    name: "initializeLogin"

    GridLayout:
        rows: 2

        GridLayout:
            cols: 1

            Label:
                font_size: '30sp' 
                text: "Page d'initialisation"
                bold: True


            Image:
                source: 'Ressources/logo.png'

        GridLayout:
            cols: 1
        
            Label:
                id: status_label
                text: "Veuillez entrer les identifiants d'initialisation."
                font_size: '24sp' 
                bold: True

            TextInput:
                id: username_textInput
                hint_text: "Nom d'utilisateur"
                font_size: '20sp'
                on_text: root.update_boutton()

            TextInput:
                id: password_textInput
                hint_text: "Mot de passe"
                font_size: '20sp' 
                password: True
                on_text: root.update_boutton()

            Button:
                id: submit_button
                text: "Se connecter"
                bold: True
                disabled: True
                on_release: root.connect()

<AddFirstAdminWindow>
    name: "addFirstAdmin"

    GridLayout:
        rows: 2

        GridLayout:
            cols: 1

            Label:
                font_size: '30sp' 
                text: "Page d'ajout du premier administrateur"
                bold: True


            Image:
                source: 'Ressources/logo.png'
            
            Label:
                text: "Veuillez entrer les identifiants du premier administrateur."
                font_size: '24sp' 
                bold: True
                
            
        GridLayout:
            cols: 1

            Label:
                id: status_label
                text: "Attention : Une fois le premier utilisateur ajouté, il est impossible de refaire cette procédure."
                bold: True

            TextInput:
                id: username_textInput
                hint_text: "Nom d'utilisateur"
                font_size: '20sp'
                on_text: root.update_boutton()

            TextInput:
                id: password_textInput
                hint_text: "Mot de passe"
                font_size: '20sp' 
                password: True
                on_text: root.update_boutton()

            Button:
                id: submit_button
                text: "Ajouter l'administrateur"
                bold: True
                disabled: True
                on_release: root.add_admin()

<LoginWindow>
    name: "login"

    GridLayout:
        rows: 2

        GridLayout:
            cols: 1

            Label:
                font_size: '30sp' 
                text: "Page de connexion"
                bold: True


            Image:
                source: 'Ressources/logo.png'

        GridLayout:
            cols: 1

            Label:
                id: status_label
                text: "Veuillez entrer vos identifiants"
                font_size: '24sp' 
                bold: True

            TextInput:
                id: username_textInput
                hint_text: "Nom d'utilisateur"
                font_size: '20sp'
                on_text: root.update_boutton()

            TextInput:
                id: password_textInput
                hint_text: "Mot de passe"
                font_size: '20sp' 
                password: True
                on_text: root.update_boutton()

            Button:
                id: submit_button
                text: "Se connecter"
                bold: True
                disabled: True
                on_release: root.login()

<NavigationFaceManagementWindow>:
    name: "navigationFaceManagement"

    FloatLayout:
        GridLayout:
            cols: 3
            size_hint: 1, 0.1
            pos_hint: {'top': 1}

            Button:
                text: "<- Retour"
                on_release:
                    app.root.current = "main"
                    root.manager.transition.direction = "right"

            Label:
                text: "Gestion des données faciales"
                bold: True

            Image:
                source: 'Ressources/logo.png'
        
        GridLayout:
            cols: 1
            size_hint_y: 0.9
            GridLayout:
                cols: 2

                Button:
                    text: "Ajouter une personne"
                    bold: True
                    on_release:
                        app.root.current = "addUser" 
                        root.manager.transition.direction = "left"

                Button:
                    text: "Supprimer / Modifier une personne"
                    bold: True
                    on_release:
                        app.root.current = "updateUser" 
                        root.manager.transition.direction = "left"

<AddUserWindow>:
    name: "addUser"

    FloatLayout:
        GridLayout:
            cols: 3
            size_hint: 1, 0.1  
            pos_hint: {'top': 1} 

            Button:
                text: "<- Retour"       
                on_release:
                    app.root.current = "navigationFaceManagement" 
                    root.manager.transition.direction = "right"

            Label:
                text: "Ajout de personnes"
                bold: True

            Image:
                source: 'Ressources/logo.png'

        GridLayout:
            cols: 1
            size_hint_y: 0.9

            Camera:
                id: qrcam
                play: False
                resolution: (640, 480)

            GridLayout:
                cols: 1

                Button:
                    id: camera_button
                    text: "Prendre une photo"       
                    on_release: 
                        root.camera_button_pressed()
                        root.enable_add_button()

                TextInput:
                    id: username_textInput
                    hint_text: "Nom de la personne"
                    on_text: root.enable_add_button()
                Spinner:
                    id: function_spinner
                    text: "Sélectionnez une fonction"
                    values: ["Fonction 1", "Fonction 2", "Fonction 3"]
                    on_text: root.enable_add_button()
                Button:
                    id: add_user_button
                    text: "Ajouter l'utilisateur"
                    on_release: root.add_user_button_pressed()
                    disabled: True
                    bold: True


<CamerasManagementWindow>:
    name: "camerasManagement"

    FloatLayout:
        GridLayout:
            cols: 3
            size_hint: 1, 0.1  
            pos_hint: {'top': 1} 

            Button:
                text: "<- Retour"       
                on_release:
                    app.root.current = "main" 
                    root.manager.transition.direction = "right"

            Label:
                text: "Gestion des cameras"
                bold: True

            Image:
                source: 'Ressources/logo.png'

        GridLayout:
            cols: 1
            size_hint_y: 0.9

            Spinner:
                id: cameras_spinner
                text: "Recherche des cameras en cours..."
                disabled: True
                on_text: root.camera_changed(self.text)
            
            Button:
                id: update_cameras_list_button
                text: "Mettre à jour la liste des cameras"
                disabled: True
                on_release: root.update_cameras_list()

            GridLayout:
                cols:2
            
                Label:
                    text: "Position relative au mur :" + str(position_slider.value)

                Slider:
                    id: position_slider
                    min: 0
                    max: 100
                    step: 1
                    value: root.get_selected_camera_positionX()
                    disabled: True
                    orientation: 'horizontal'
                    on_value: root.update_positionX(self.value)


            Spinner:
                id: walls_spinner
                text: "Select a Wall"
                disabled: True
                values: root.get_wall_names()
                on_text: root.wall_changed(self.text)

            
            Button:
                id: update_camera_button
                text: "Mettre à jour la camera"
                disabled: True
                on_release: root.update_camera()
                disabled: True
                bold: True

<UpdateUserWindow>:
    name: "updateUser"
    
    FloatLayout:
        GridLayout:
            cols: 3
            size_hint: 1, 0.1
            pos_hint: {'top': 1}

            Button:
                text: "<- Retour"
                on_release:
                    app.root.current = "navigationFaceManagement"
                    root.manager.transition.direction = "right"

            Label:
                text: "SRS : Modification d'utilisateurs"
                bold: True

            Image:
                source: 'Ressources/logo.png'
        
        GridLayout:
            cols: 1
            size_hint_y: 0.9

            GridLayout:
                cols: 1

                Label:
                    id: status_label
                    text: "Veuillez remplir le formulaire"
                    font_size: '24sp' 
                    bold: True

                Spinner:
                    id: user_spinner
                    text: "Recherche d'utilisateurs en cours..."
                    disabled: True
                    on_text: root.user_changed(self.text)
                
                TextInput:
                    id: username_textInput
                    disabled: True
                    hint_text: "Nom de la personne"

                Spinner:
                    id: person_type_spinner
                    text: ""
                    disabled: True
            
            GridLayout:
                cols: 1

                Camera:
                    play: False
                    id: update_camera
                    resolution: (640, 480)
            
            GridLayout:
                cols: 1

                Button:
                    id: take_picture_button
                    text: "Prendre une photo"
                    disabled: True
                    on_release: root.take_picture()
                
                Button:
                    id: update_user_button
                    text: "Modifier l'utilisateur"
                    disabled: True
                    on_release: root.update_user()
                
                Button:
                    id: delete_user_button
                    text: "Supprimer l'utilisateur"
                    disabled: True
                    on_release: root.show_delete_confirmation()
                    background_color: (1, 0, 0, 1)
                    background_normal: ''
